"use strict";(self["webpackChunkvue01"]=self["webpackChunkvue01"]||[]).push([[456],{23397:function(e,t,a){a.d(t,{aD:function(){return i},AY:function(){return l},$i:function(){return c}});var s=a(94373),r=a(89143);const n=s.A.create({baseURL:"https://your-api-domain.com/api",timeout:3e4,headers:{"Content-Type":"application/json;charset=UTF-8"}});n.interceptors.request.use(e=>e,e=>(console.error("Request Error:",e),Promise.reject(e))),n.interceptors.response.use(e=>{const t=e.data;return!1===t.success?((0,r.Message)({message:t.error||t.detail||"Request Failed",type:"error",duration:3e3}),Promise.reject(new Error(t.error||t.detail||"Request Failed"))):t},e=>{console.error("响应错误:",e);let t="网络错误";if(e.response)switch(e.response.status){case 400:t="请求参数错误";break;case 401:t="未授权，请重新登录";break;case 403:t="拒绝访问";break;case 404:t="请求的资源不存在";break;case 500:t="服务器内部错误";break;case 502:t="网关错误";break;case 503:t="服务不可用";break;default:t=`连接错误 ${e.response.status}`}else e.message.includes("timeout")?t="请求超时":e.message.includes("Network Error")&&(t="网络连接失败");return(0,r.Message)({message:t,type:"error",duration:3e3}),Promise.reject(e)});var o=n;const i={getTradeTension(){return o({url:"/tension/distribution",method:"get"})},getTradeTensionList(e){return o({url:"/tension/details",method:"get",params:e})},getTradeTensionTrend(){return o({url:"/tension/trend",method:"get"})}},l={fetchNews(e){return o({url:"/news/trade",method:"get",params:e})},fetchAllNews(e){return o({url:"/news/fetch-all",method:"post",params:e})},getQueryHistory(){return o({url:"/news/query-history",method:"get"})},getArticlesList(e){return o({url:"/articles/list",method:"get",params:e})},getArticleDetail(e){return o({url:`/articles/${e}`,method:"get"})}},c={analyzeByUrl(e){return o({url:"/nlp/analyze",method:"post",data:e})},analyzeByText(e){return o({url:"/nlp/analyze",method:"post",data:e})},analyzeByUuid(e){return l.getArticleDetail(e)}}},72456:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"crawler-page"},[t("el-card",{staticClass:"input-card",attrs:{shadow:"never"}},[t("div",{staticClass:"card-header-content",attrs:{slot:"header"},slot:"header"},[t("span",{staticClass:"card-title"},[t("i",{staticClass:"el-icon-link"}),e._v(" News Crawl Configuration ")])]),t("InputForm",{ref:"inputForm",attrs:{"button-text":"Start Crawling",loading:e.crawling},on:{submit:e.handleCrawl,reset:e.handleReset},scopedSlots:e._u([{key:"extra-fields",fn:function(){return[t("el-form-item",{attrs:{label:"Time Range"}},[t("el-date-picker",{attrs:{type:"daterange","range-separator":"to","start-placeholder":"Start Date","end-placeholder":"End Date","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),t("el-form-item",{attrs:{label:"News Count"}},[t("el-input-number",{attrs:{min:1,max:3,step:1},model:{value:e.newsCount,callback:function(t){e.newsCount=t},expression:"newsCount"}})],1)]},proxy:!0}])})],1),t("el-card",{staticClass:"result-card-container",attrs:{shadow:"never"}},[t("div",{staticClass:"card-header-content",attrs:{slot:"header"},slot:"header"},[t("span",{staticClass:"card-title"},[t("i",{staticClass:"el-icon-document"}),e._v(" Crawl Results (Total "+e._s(e.newsList.length)+" items) ")]),e.newsList.length>0?t("el-button",{attrs:{type:"text",icon:"el-icon-download"},on:{click:e.handleExport}},[e._v(" Export Data ")]):e._e()],1),0!==e.newsList.length||e.crawling?e._e():t("el-empty",{attrs:{description:"No crawl results, please configure and start crawling first"}}),e.crawling?t("div",{staticClass:"loading-container"},[t("el-progress",{attrs:{percentage:e.crawlProgress,status:100===e.crawlProgress?"success":null}}),t("p",{staticClass:"loading-text"},[e._v("Crawling news, please wait...")])],1):e._e(),e.newsList.length>0&&!e.crawling?t("div",{staticClass:"news-list"},[e._l(e.displayedNews,function(a,s){return t("ResultCard",{key:s,attrs:{title:a.title,extra:a.source},scopedSlots:e._u([{key:"footer",fn:function(){return[t("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-view"},on:{click:function(t){return e.handleViewSource(a.url)}}},[e._v(" View Source ")]),t("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-document"},on:{click:function(t){return e.handleAnalyze(a)}}},[e._v(" Analyze Content ")])]},proxy:!0}],null,!0)},[t("div",{staticClass:"news-content"},[t("p",{staticClass:"news-summary"},[e._v(e._s(a.summary))]),t("div",{staticClass:"news-meta"},[t("span",{staticClass:"news-time"},[t("i",{staticClass:"el-icon-time"}),e._v(" "+e._s(a.publishTime)+" ")]),t("span",{staticClass:"news-crawl-time"},[t("i",{staticClass:"el-icon-download"}),e._v(" Crawl Time: "+e._s(a.crawlTime)+" ")])])])])}),e.hasMore?t("div",{staticClass:"load-more"},[t("el-button",{on:{click:e.loadMore}},[e._v("Load More")])],1):e._e()],2):e._e()],1)],1)},r=[],n=(a(44114),a(18111),a(61701),a(14603),a(47566),a(98721),function(){var e=this,t=e._self._c;return t("div",{staticClass:"input-form-container"},[t("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,"label-width":"100px","label-position":"left"}},[t("el-form-item",{attrs:{label:"Country 1",prop:"country1"}},[t("el-select",{attrs:{placeholder:"Please select country",filterable:"",clearable:""},model:{value:e.formData.country1,callback:function(t){e.$set(e.formData,"country1",t)},expression:"formData.country1"}},e._l(e.countryList,function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})}),1)],1),t("el-form-item",{attrs:{label:"Country 2",prop:"country2"}},[t("el-select",{attrs:{placeholder:"Please select country",filterable:"",clearable:""},model:{value:e.formData.country2,callback:function(t){e.$set(e.formData,"country2",t)},expression:"formData.country2"}},e._l(e.countryList,function(e){return t("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})}),1)],1),e._t("extra-fields"),t("el-form-item",[t("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v(" "+e._s(e.buttonText)+" ")]),t("el-button",{on:{click:e.handleReset}},[e._v("Reset")])],1)],2)],1)}),o=[],i={name:"InputForm",props:{buttonText:{type:String,default:"Submit"},loading:{type:Boolean,default:!1},initialData:{type:Object,default:()=>({})}},data(){return{formData:{country1:"",country2:""},rules:{country1:[{required:!0,message:"Please select Country 1",trigger:"change"}],country2:[{required:!0,message:"Please select Country 2",trigger:"change"}]},countryList:[{code:"CN",name:"China"},{code:"US",name:"USA"},{code:"EU",name:"EU"},{code:"JP",name:"Japan"},{code:"KR",name:"South Korea"},{code:"ASEAN",name:"ASEAN"},{code:"UK",name:"UK"},{code:"DE",name:"Germany"},{code:"FR",name:"France"},{code:"CA",name:"Canada"},{code:"AU",name:"Australia"},{code:"IN",name:"India"},{code:"BR",name:"Brazil"},{code:"RU",name:"Russia"},{code:"MX",name:"Mexico"}]}},mounted(){this.initialData&&(this.formData={...this.formData,...this.initialData})},methods:{handleSubmit(){this.$refs.form.validate(e=>{if(!e)return this.$message.warning("Please fill in complete information"),!1;this.$emit("submit",this.formData)})},handleReset(){this.$refs.form.resetFields(),this.$emit("reset")},getFormData(){return this.formData},setFormData(e){this.formData={...this.formData,...e}}}},l=i,c=a(81656),u=(0,c.A)(l,n,o,!1,null,"fcc8b222",null),d=u.exports,m=function(){var e=this,t=e._self._c;return t("div",{staticClass:"result-card",class:{"is-loading":e.loading}},[e.loading?t("div",{staticClass:"loading-container"},[t("i",{staticClass:"el-icon-loading"}),t("span",[e._v("Loading...")])]):t("div",{staticClass:"card-content"},[e.title||e.$slots.header?t("div",{staticClass:"card-header"},[e._t("header",function(){return[t("h3",{staticClass:"card-title"},[e._v(e._s(e.title))]),e.extra?t("div",{staticClass:"card-extra"},[t("span",[e._v(e._s(e.extra))])]):e._e()]})],2):e._e(),t("div",{staticClass:"card-body"},[e._t("default")],2),e.$slots.footer?t("div",{staticClass:"card-footer"},[e._t("footer")],2):e._e()])])},h=[],p={name:"ResultCard",props:{title:{type:String,default:""},extra:{type:String,default:""},loading:{type:Boolean,default:!1}}},g=p,w=(0,c.A)(g,m,h,!1,null,"0195ffce",null),y=w.exports,f=a(23397),C={name:"CrawlerTool",components:{InputForm:d,ResultCard:y},data(){return{crawling:!1,crawlProgress:0,dateRange:[],newsCount:3,newsList:[],displayCount:10,pickerOptions:{shortcuts:[{text:"Last Week",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"Last Month",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"Last 3 Months",onClick(e){const t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}}},computed:{displayedNews(){return this.newsList.slice(0,this.displayCount)},hasMore(){return this.displayCount<this.newsList.length}},mounted(){if(this.$route.query.region){const e={country1:"CN",country2:this.getCountryCode(this.$route.query.region)};this.$refs.inputForm.setFormData(e)}},methods:{async handleCrawl(e){this.crawling=!0,this.crawlProgress=0,this.newsList=[];const t=setInterval(()=>{this.crawlProgress<90&&(this.crawlProgress+=10)},500);try{const a=this.getCountryName(e.country1),s=this.getCountryName(e.country2);let r="",n="";if(this.dateRange&&2===this.dateRange.length){const e=e=>{const t=new Date(e);let a=""+(t.getMonth()+1),s=""+t.getDate();const r=t.getFullYear();return a.length<2&&(a="0"+a),s.length<2&&(s="0"+s),[r,a,s].join("-")};r=e(this.dateRange[0]),n=e(this.dateRange[1])}else{const e=new Date,t=new Date;t.setDate(t.getDate()-30);const a=e=>{const t=new Date(e);let a=""+(t.getMonth()+1),s=""+t.getDate();const r=t.getFullYear();return a.length<2&&(a="0"+a),s.length<2&&(s="0"+s),[r,a,s].join("-")};r=a(t),n=a(e)}console.log("查询参数:",{country1:a,country2:s,start_date:r,end_date:n});const o=await f.AY.fetchNews({country1:a,country2:s,start_date:r,end_date:n,limit:this.newsCount||50});clearInterval(t),this.crawlProgress=100,console.log("后端返回:",o);const i=Array.isArray(o)?o:o.data||[];if(!(i.length>0))throw new Error("未获取到新闻数据");this.newsList=i.map((e,t)=>({uuid:e.uuid||t,title:e.title||"无标题",source:e.source||"未知来源",summary:e.description||e.snippet||"暂无摘要",url:e.url,publishTime:e.published_at?new Date(e.published_at).toLocaleDateString():"未知时间",crawlTime:(new Date).toLocaleString(),content:e.content,sentiment:e.sentiment,aiSummary:e.ai_summary})),setTimeout(()=>{this.crawling=!1,this.$message.success(`成功获取 ${this.newsList.length} 条新闻`)},500)}catch(a){clearInterval(t),this.crawling=!1;const e=a.response?.data?.detail||a.message||"获取新闻失败，请重试";this.$message.error(e),console.error("获取新闻失败:",a)}},handleReset(){this.dateRange=[],this.newsCount=50,this.newsList=[],this.displayCount=10},handleViewSource(e){window.open(e,"_blank")},handleAnalyze(e){this.$router.push({path:"/nlp",query:{url:e.url,uuid:e.uuid}})},handleExport(){const e=JSON.stringify(this.newsList,null,2),t=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=`news_export_${(new Date).getTime()}.json`,s.click(),URL.revokeObjectURL(a),this.$message.success("导出成功")},loadMore(){this.displayCount+=10},getCountryCode(e){const t={"美国":"US","欧盟":"EU","日本":"JP","韩国":"KR","东盟":"ASEAN"};return t[e]||"US"},getCountryName(e){const t={CN:"China",US:"United States",EU:"European Union",JP:"Japan",KR:"South Korea",ASEAN:"ASEAN",UK:"United Kingdom",DE:"Germany",FR:"France",CA:"Canada",AU:"Australia",IN:"India",BR:"Brazil",RU:"Russia",MX:"Mexico"};return t[e]||e},getRandomDate(){const e=Math.floor(30*Math.random()),t=new Date;return t.setDate(t.getDate()-e),t.toISOString().split("T")[0]},getCurrentTime(){return(new Date).toLocaleString("zh-CN")}}},_=C,v=(0,c.A)(_,s,r,!1,null,"c4f42dac",null),b=v.exports}}]);
//# sourceMappingURL=456.df2a6675.js.map